<?php

namespace WHMCS\Admin\Setup;

class SetupTasks
{
    public function evaluateAndGet()
    {
        return [["label" => \AdminLang::trans("setupTask.general"), "link" => "configgeneral.php", "completed" => $this->isCompanyNameAndLogoSet()], ["label" => \AdminLang::trans("setupTask.automation"), "link" => "configauto.php", "completed" => (new \WHMCS\Cron\Status())->hasCronEverBeenInvoked()], ["label" => \AdminLang::trans("setupTask.gateways"), "link" => "configgateways.php", "completed" => 0 < count((new \WHMCS\Module\Gateway())->getActiveGateways())], ["label" => \AdminLang::trans("setupTask.merchant"), "link" => "configgateways.php?type=merchant", "completed" => 0 < count((new \WHMCS\Module\Gateway())->getMerchantGateways())], ["label" => \AdminLang::trans("setupTask.registrars"), "link" => "configregistrars.php", "completed" => 0 < count((new \WHMCS\Module\Registrar())->getActiveModules())], ["label" => \AdminLang::trans("setupTask.product"), "link" => "configproducts.php", "completed" => 0 < \WHMCS\Product\Product::count()], ["label" => \AdminLang::trans("setupTask.support"), "link" => "configticketdepartments.php", "completed" => 0 < \WHMCS\Support\Department::count()], ["label" => \AdminLang::trans("setupTask.notifications"), "link" => routePath("admin-setup-notifications-overview"), "completed" => 0 < \WHMCS\Notification\Rule::active()->count()], ["label" => \AdminLang::trans("setupTask.marketconnectSSL"), "link" => "marketconnect.php?learnmore=symantec", "completed" => \WHMCS\MarketConnect\MarketConnect::isActive("symantec")], ["label" => \AdminLang::trans("setupTask.marketconnectWeebly"), "link" => "marketconnect.php?learnmore=weebly", "completed" => \WHMCS\MarketConnect\MarketConnect::isActive("weebly")], ["label" => \AdminLang::trans("setupTask.marketconnectSitelock"), "link" => "marketconnect.php?learnmore=sitelock", "completed" => \WHMCS\MarketConnect\MarketConnect::isActive("sitelock")], ["label" => \AdminLang::trans("setupTask.marketconnectSitelockVPN"), "link" => "marketconnect.php?learnmore=sitelockvpn", "completed" => \WHMCS\MarketConnect\MarketConnect::isActive("sitelockvpn")], ["label" => \AdminLang::trans("setupTask.marketconnectNordVPN"), "link" => "marketconnect.php?learnmore=nordvpn", "completed" => \WHMCS\MarketConnect\MarketConnect::isActive("nordvpn")], ["label" => \AdminLang::trans("setupTask.marketconnectSpam"), "link" => "marketconnect.php?learnmore=spamexperts", "completed" => \WHMCS\MarketConnect\MarketConnect::isActive("spamexperts")], ["label" => \AdminLang::trans("setupTask.marketconnectOpenXchange"), "link" => "marketconnect.php?learnmore=ox", "completed" => \WHMCS\MarketConnect\MarketConnect::isActive("ox")], ["label" => \AdminLang::trans("setupTask.signInIntegrations"), "link" => routePath("admin-setup-authn-view"), "completed" => 0 < \WHMCS\Authentication\Remote\ProviderSetting::enabled()->count()], ["label" => \AdminLang::trans("setupTask.applicationLinks"), "link" => "configapplinks.php", "completed" => 0 < \WHMCS\ApplicationLink\ApplicationLink::where("module_type", "servers")->where("module_name", "cpanel")->where("is_enabled", 1)->count()], ["label" => \AdminLang::trans("setupTask.backups"), "link" => "configbackups.php", "completed" => 0 < count((new \WHMCS\Backups\Backups())->getActiveProviders())]];
    }

    protected function isCompanyNameAndLogoSet()
    {
        return \WHMCS\Config\Setting::getValue("CompanyName") != "Company Name" && \WHMCS\Config\Setting::getValue("LogoURL");
    }
}
